$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
$ docker pull golang:1.10.3
1.10.3: Pulling from library/golang
0bd44ff9c2cf: Already exists 
047670ddbd2a: Already exists 
ea7d5dc89438: Already exists 
ae7ad5906a75: Already exists 
15f6351ddb37: Already exists 
823ef4e8c9c9: Already exists 
dca1089cfb86: Already exists 
Digest: sha256:a80227ad1a3e44c6640050440f14eeb47fea573854b803c32a8d7c6d06886819
Status: Downloaded newer image for golang:1.10.3
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB
$ time make build.docker
go build -o hellogo -v
docker build --rm -t dockerhub/hellogo:fbc30a3-dirty -f Dockerfile .
Sending build context to Docker daemon  21.17MB
Step 1/3 : FROM golang:1.10.3 as builder
 ---> 4e611157870f
Step 2/3 : COPY hellogo .
 ---> 8d9926e56588
Step 3/3 : CMD ["./hellogo"]
 ---> Running in 9db23e5450e0
Removing intermediate container 9db23e5450e0
 ---> 8e60ef3c1485
Successfully built 8e60ef3c1485
Successfully tagged dockerhub/hellogo:fbc30a3-dirty

real	0m0.814s
user	0m0.264s
sys	0m0.056s


$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
dockerhub/hellogo   fbc30a3-dirty       8e60ef3c1485        7 seconds ago       801MB
golang              1.10.3              4e611157870f        7 days ago          794MB
$ docker rmi 8e60ef3c1485
Untagged: dockerhub/hellogo:fbc30a3-dirty
Deleted: sha256:8e60ef3c1485bf3c96f506ab7c2964ae658cee9aebdcafb006cad245349baa23
Deleted: sha256:8d9926e56588bf17662f779f3d343e23b1c2f9d955de178c469c3045293d96ef
Deleted: sha256:6e03c93b14341c16b760264e394ab806c10b09654679a61082718b690c7dc0d5
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB
$ time make build.docker-cache
go build -o hellogo -v
docker build --cache-from golang:1.10.3 --cache-from alpine:latest -t dockerhub/hellogo:fbc30a3-dirty -f Dockerfile .
Sending build context to Docker daemon  21.17MB
Step 1/3 : FROM golang:1.10.3 as builder
 ---> 4e611157870f
Step 2/3 : COPY hellogo .
 ---> 6337bd501c9d
Step 3/3 : CMD ["./hellogo"]
 ---> Running in 002af2b02d87
Removing intermediate container 002af2b02d87
 ---> ddada07748a6
Successfully built ddada07748a6
Successfully tagged dockerhub/hellogo:fbc30a3-dirty

real	0m0.852s
user	0m0.276s
sys	0m0.056s



$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
dockerhub/hellogo   fbc30a3-dirty       ddada07748a6        6 seconds ago       801MB
golang              1.10.3              4e611157870f        7 days ago          794MB
$ docker rmi ddada07748a6
Untagged: dockerhub/hellogo:fbc30a3-dirty
Deleted: sha256:ddada07748a6bfaf7a1317ddaf9923581a558bb4b5c99a0e204fc87aba7ab1b2
Deleted: sha256:6337bd501c9d6119b04eb78acdf93e048f9c58a69385e1696aeabc497c7da287
Deleted: sha256:ff54e161c204e0c20edf9798f2de037cdec620d234497020210902682678cad4
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB



$ time make build.dockerbuilder
go build -o hellogo -v
docker build --rm -t dockerhub/hellogo:fbc30a3-dirty -f Dockerfile .
Sending build context to Docker daemon  21.18MB
Step 1/3 : FROM golang:1.10.3 as builder
 ---> 4e611157870f
Step 2/3 : COPY hellogo .
 ---> 1e7ed8efcec0
Step 3/3 : CMD ["./hellogo"]
 ---> Running in b4e5aa99640a
Removing intermediate container b4e5aa99640a
 ---> ce08a7ff8ed0
Successfully built ce08a7ff8ed0
Successfully tagged dockerhub/hellogo:fbc30a3-dirty

real	0m0.791s
user	0m0.284s
sys	0m0.028s


$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
dockerhub/hellogo   fbc30a3-dirty       ce08a7ff8ed0        4 seconds ago       801MB
golang              1.10.3              4e611157870f        7 days ago          794MB
$ docker rmi ce08a7ff8ed0
Untagged: dockerhub/hellogo:fbc30a3-dirty
Deleted: sha256:ce08a7ff8ed0381aba9c269500030f032360e12bda2be071bd026aff995fbf84
Deleted: sha256:1e7ed8efcec04315498d8e59d2fa75c1dafd291d538a99ce9a4382cf4a37319c
Deleted: sha256:7975ef1528769495dd5b61bed32c87c4d9fb0371af70013e60d20fe27c574a95
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB



$ time make build.dockerbuilder-cache
go build -o hellogo -v
docker build --cache-from golang:1.10.3 --cache-from alpine:latest -t dockerhub/hellogo:fbc30a3-dirty -f DockerfileBuilder .
Sending build context to Docker daemon  21.18MB
Step 1/9 : FROM golang:1.10.3 as builder
 ---> 4e611157870f
Step 2/9 : WORKDIR /go/src/github.com/lotharschulz/hellogodocker/
Removing intermediate container 05deef88ad61
 ---> a50a9aa800d8
Step 3/9 : COPY hello.go	.
 ---> d449d044eb76
Step 4/9 : RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o hellogodocker .
 ---> Running in 0f8d2ef7f2cb
Removing intermediate container 0f8d2ef7f2cb
 ---> c8029facf453
Step 5/9 : FROM alpine:latest
latest: Pulling from library/alpine
ff3a5c916c92: Already exists 
Digest: sha256:e1871801d30885a610511c867de0d6baca7ed4e6a2573d506bbec7fd3b03873f
Status: Downloaded newer image for alpine:latest
 ---> 3fd9065eaf02
Step 6/9 : RUN apk --no-cache add ca-certificates
 ---> Running in a0cedc80d81c
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/main/x86_64/APKINDEX.tar.gz
fetch http://dl-cdn.alpinelinux.org/alpine/v3.7/community/x86_64/APKINDEX.tar.gz
(1/1) Installing ca-certificates (20171114-r0)
Executing busybox-1.27.2-r7.trigger
Executing ca-certificates-20171114-r0.trigger
OK: 5 MiB in 12 packages
Removing intermediate container a0cedc80d81c
 ---> 412e009a0dfe
Step 7/9 : WORKDIR /root/
Removing intermediate container bffe60f3a267
 ---> 50db230338f9
Step 8/9 : COPY --from=builder /go/src/github.com/lotharschulz/hellogodocker/hellogodocker .
 ---> cc8858050e69
Step 9/9 : CMD ["./hellogodocker"]
 ---> Running in 0268e7ccc8a5
Removing intermediate container 0268e7ccc8a5
 ---> 42cd8088ab04
Successfully built 42cd8088ab04
Successfully tagged dockerhub/hellogo:fbc30a3-dirty

real	0m14.684s
user	0m0.268s
sys	0m0.060s


$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
dockerhub/hellogo   fbc30a3-dirty       42cd8088ab04        4 seconds ago       11.3MB
<none>              <none>              c8029facf453        9 seconds ago       816MB
golang              1.10.3              4e611157870f        7 days ago          794MB
alpine              latest              3fd9065eaf02        5 months ago        4.15MB
$ docker rmi -f c8029facf453 3fd9065eaf02 42cd8088ab04
Deleted: sha256:c8029facf4534d906ba05f6945cf6c5b2d70932c60881fd7feb665cf6d741837
Deleted: sha256:57501ce46cb9722ca2f4d2e8a921056e601f73eefc0e4f6bce7d622e8f503bc3
Deleted: sha256:d449d044eb76775fb2cb816780e61196376a49712daa9610cd81666fb74fd597
Deleted: sha256:d864a02090b5dd4a23b6cd553bd13fcb2ff371bbf2c8d2f9899fafec6371306e
Deleted: sha256:a50a9aa800d80d854e919a777a84e5d3688ca91b38c714fe2f212b9b135d62e8
Deleted: sha256:5c3148cafd71c66b621f765280f4a4787dfb398f4907e973e05e035eb45b3bf5
Untagged: dockerhub/hellogo:fbc30a3-dirty
Deleted: sha256:42cd8088ab042dd3c173b955bcebb3bfbbf19fe5ad291ae331b5e6940365ba06
Deleted: sha256:cc8858050e695de246f671ec5784eeebd9e7f7c69d8ab1854ac55f52d9991105
Deleted: sha256:16ef7dd82940b24bc5da2ab89467c52a3cd07c46b1b6e3e65256aacb1e1fb64d
Deleted: sha256:50db230338f9bd37e321409cd33b3e728697fca2c72bee06fb1700a39cc0d2cb
Deleted: sha256:412e009a0dfef2623cf83e631ab1c4c298317b9ddce033353494c83a79d8b9f9
Deleted: sha256:7b053d6b7d066c091a503395f0305b9d69f7ba824c823379d91c430f3634f3cc
Error response from daemon: conflict: unable to delete 3fd9065eaf02 (cannot be forced) - image has dependent child images
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB
alpine              latest              3fd9065eaf02        5 months ago        4.15MB
$ docker rmi -f 3fd9065eaf02
Untagged: alpine:latest
Untagged: alpine@sha256:e1871801d30885a610511c867de0d6baca7ed4e6a2573d506bbec7fd3b03873f
Deleted: sha256:3fd9065eaf02feaf94d68376da52541925650b81698c53c6824d92ff63f98353
$ docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
golang              1.10.3              4e611157870f        7 days ago          794MB
